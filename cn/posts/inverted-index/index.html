<!doctype html><html charset=utf-8 lang=en><head><script src="https://www.googletagmanager.com/gtag/js?id=G-SR36ZS0R52" async></script><script>window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }

  var page_link = new URL(window.location.href);
  gtag('js', new Date());
  gtag('config', 'G-SR36ZS0R52', {
    traffic_type: page_link.searchParams.get("traffic_type")
  });
  gtag('set', {
    traffic_type: page_link.searchParams.get("traffic_type")
  })</script><link href=https://eindex.me/cn/feed.xml rel=alternate title=RSS type=application/rss+xml><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="text/html; charset=utf-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1.0,maximum-scale=1" name=viewport><meta content=EINDEX itemprop=author name=author><title>倒排索引 • EINDEX's Blog</title><meta content="倒排索引 • EINDEX's Blog" property=og:title><meta charset=utf-8><link href="https://eindex.me/css/index.css?h=b4140d1b8e3196cffd2e47c68ff946d2e5312afa70cfe5c88add4caebf732a9e" rel=stylesheet><style>@-moz-document url-prefix() {
    .lazy:-moz-loading {
      visibility: hidden;
    }
  }

  .ieOnly {
    display: none;
  }

  @media all and (-ms-high-contrast: none),
  (-ms-high-contrast: active) {
    .ieOnly {
      display: block;
    }
  }</style><link href=https://webmention.io/eindex.me/webmention rel=webmention><link href=https://webmention.io/eindex.me/xmlrpc rel=pingback><script src=https://cdn.jsdelivr.net/npm/iconify-icon@1.0.1/dist/iconify-icon.min.js></script><link href=/favicon-512.png rel=apple-touch-icon sizes=512x512><link href=/favicon-512.png rel=icon sizes=512x512 type=image/png><link href=/favicon-192.png rel=icon sizes=192x192 type=image/png><link href=/manifest.json rel=manifest><meta content=on name=twitter:dnt><meta content=on name=twitter:widgets:csp><meta content=https://eindex.me/cn/posts/inverted-index/ property=og:url><meta content="EINDEX's Blog" property=og:site_name><meta content=https://eindex.me/images/avatar.png property=og:image><meta content=summary name=twitter:card><meta content=倒排索引 name=twitter:title><meta content=@eindex_li name=twitter:site><meta content=@eindex_li name=twitter:creator><meta content=https://eindex.me/images/avatar.png name=twitter:image><link href=https://twitter.com/eindex_li rel=me><script type=application/ld+json>
{
  "@context": "https://schema.org/",
  "@type": "BlogPosting",
  "headline": "倒排索引",
  "image": "https://eindex.me/images/avatar.png",
  
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://eindex.me/cn/posts/inverted-index/"
  },
  
  "datePublished": "2019-08-27",
  
  
  "author": {
    "@type": "Person",
    "name": "EINDEX",
    "url": "https://eindex.me/about"
  },
  "publisher": {
    "@type": "Organization",
    "name": "EINDEX's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://eindex.me/images/avatar.png"
    }
  },
  "keywords": ["Index","Search Engine","algorithm"]
}
</script><link href=https://cdn.jsdelivr.net/npm/docs-searchbar.js@2.4.1/dist/cdn/docs-searchbar.min.css rel=stylesheet><script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1265138627025369" async crossorigin=anonymous></script><body><div class=all><header><nav class=navbar><div class=avatar><a href="https://eindex.me/cn/ @/_index.md" class=site-link><img alt=Workflow class=avatar src=https://eindex.me/processed_images/e75389feba7c019600.png></a></div><div class=menus><a href="https://eindex.me/cn/ @/gallery.md">相册</a><a href="https://eindex.me/cn/ @/archive.md">归档</a></div><div class=switcher><a class="language switch" href="https://eindex.me/ @/_index.md"><iconify-icon icon=ri:english-input></iconify-icon></a></div></nav></header><div class=content><main><article class=h-entry data-clarity-region=article><section class=header><section class=title-area><a class="series p-category" href=https://eindex.me/cn/series/algorithm/>算法</a><h1 class="title p-name"><a class=u-url href=https://eindex.me/cn/posts/inverted-index/>倒排索引</a></h1></section><section class=meta-area><p style="display: none;" class=p-summary>&LTp>世界上最伟大的互联网产品,说是搜索引擎,绝对没有别的产品可以替代,尤其是伟大的先在市场占用率最高的搜索引擎,Google Search.&LT/p> &LTp>还有很多差一大截的,比如 Bing, Yahoo 和 YANDEX.&LT/p></p><span><iconify-icon icon=ant-design:calendar-outlined></iconify-icon> <time class=dt-published>2019-08-27</time> </span><span><iconify-icon icon=bx:time-five></iconify-icon> 5 mins</span><span style=display:none><iconify-icon icon=mdi:eye-outline></iconify-icon> <span id=pv></span> views</span></section></section><div class="p-author h-card" style="display: none;"><img class="u-logo u-photo" src="https://eindex.me/ /images/avatar.png"><a class="p-nickname p-name u-url" href=https://eindex.me>EINDEX</a><p class=p-note>My goal is make happy.</div><section class="main e-content"><p>世界上最伟大的互联网产品,说是搜索引擎,绝对没有别的产品可以替代,尤其是伟大的先在市场占用率最高的搜索引擎,Google Search.<p>还有很多差一大截的,比如 Bing, Yahoo 和 YANDEX.</p><span id=continue-reading></span><h2 id=shi-yao-shi-sou-suo-yin-qing>什么是搜索引擎</h2><p>所谓搜索引擎，就是根据用户需求与一定算法，运用特定策略从互联网检索出制定信息反馈给用户的一门检索技术。<p>搜索引擎技术的核心模块一般包括爬虫、索引、检索和排序等，同时可添加其他一系列辅助模块，以为用户创造更好的网络使用环境。<h2 id=sou-suo-yin-qing-gan-liao-xie-shi-yao>搜索引擎干了些什么</h2><p>简单的说搜索引擎从网络上爬取网页,然后对网页信息进行提取,构建正排索引,然后分析网页内容,建立倒排文件.<p>接下来我将依次介绍 正排索引、 倒排索引 等知识点.<h2 id=zheng-pai-suo-yin>正排索引</h2><p>正排索引通常是 id-document 的键值对<table><thead><tr><th>id<th>name<th>context<th>eng_context<tbody><tr><td>1<td>小明<td>今天吃了3个包子<td>today eating 3 baozi<tr><td>2<td>小仓<td>最后一天看了一本书<td>read a book last day<tr><td>3<td>仓颉<td>去年造了个新华字典<td>make a xinhua dictionary last year</table><h2 id=dao-pai-suo-yin>倒排索引</h2><p>倒排索引是关键词到id列表的映射关系.<p>倒排索引里面左边的列叫做 term , 里面存储的通常是一个关键词; 右边的列叫做 posting list,里面存储的是文档的id.<p>左侧的一列一起叫做 term dictionary.<p>首先上面有每个 document 有3个 field , 所以会创建3个倒排索引.<p>如果使用默认的英文分词器,那么表格会创建的索引大概是下面这个样子:<p>name index:<table><thead><tr><th>term<th>posting list<tbody><tr><td>小<td>[1, 2]<tr><td>仓<td>[2, 3]<tr><td>明<td>[1]<tr><td>颉<td>[3]</table><p>context index:<table><thead><tr><th>term<th>posting list<tbody><tr><td>个<td>[1, 3]<tr><td>了<td>[1, 2, 3]<tr><td>今<td>[1]<tr><td>...<td>...</table><p>eng_context index:<table><thead><tr><th>term<th>posting list<tbody><tr><td>last<td>[2, 3]<tr><td>a<td>[2, 3]<tr><td>dictionary<td>[3]<tr><td>...<td>...</table><hr><p>读到这里想来你也会有些许疑问?<ul><li>比 MySQL Index 的优势在哪?<li>当有1亿 Term 时如何高效查询?<li>联合查询怎么办?<li>相关度排序?</ul><h2 id=term-index>Term index</h2><p>假象一下我们现在有 1 亿个 term, 那么这个 trem dictionary 会占多少内存呢? 假设每个 trem 占用内存 6 byte, 那么亿个大约占用 0.6 GB, 那么如果是一个非常复杂的文档, 岂不是内存不够用? 而且为什么搜索引擎的速度远远快于MySQL 的索引速度?<p>首先 Trem Index 实际上是一种字典树(前缀树), 可以将 term dictionary 里的内容组成树状结构. 下图会是一个普通的字典树. <img alt src=https://eindex.me/cn/posts/inverted-index/media/15669198838069/15673442795943.jpg><p>而 Term Index 的 Value 就是 Term 在磁盘中的位置.<p>而且 Trem Index 通常会被缓存到内存中, 再加上优秀的树结构, 所以查询速度极快, 字典树的数据结构优势, 使体积远小于 term dictonary.<p>快于 MySQL 的主要原因是, 减少了访问磁盘的次数.MySQL 的B+树会在磁盘中多次读写不同位置, 而使用 term index , 则只会在匹配到 term 时进行一次磁盘访问.<h2 id=lian-he-cha-xun>联合查询</h2><p>如何进行索引的联合查询, 当程序获得多个Posting list 那么程序需要从list 中进行多次交集并集操作.如何减少这些操作呢?<p>通常有两个解决方案.<ul><li>bitset<li>跳表</ul><p>可以自己去看一下相关的工作原理。<h2 id=end>END</h2><p>想必看完之后，你也对倒排索引工作原理有一定的了解了吧。感谢阅读！</section><section class=post-footer><div class=tags><span class=tag><a href=https://eindex.me/cn/tags/index/>Index</a></span><span class=tag><a href=https://eindex.me/cn/tags/search-engine/>Search Engine</a></span></div></section><hr><section class=webmentions><h2>Response</h2><p class=how-to-send-webmention>Have you written any responses to this article? If so, please send your article or tweet link below. (Making sure to include the link of this article in the content, learn more about webmentions from <a href=https://indieweb.org/Webmention>here</a>.)<form action=https://webmention.io/eindex.me/webmention class=webmention-form method=post><input name=target type=hidden value=https://eindex.me/cn/posts/inverted-index/><input placeholder="Your webmention link" name=source><button>Send Webmention</button></form><p class="flex flex-row how-to-send-webmention"><a class=twitter-share-button href=https://twitter.com/intent/tweet>Tweet</a>  and send response. .</section></article></main><aside><section class=search><input id=search-bar-input placeholder=Searching... type=search></section><section><h3 class=section-title>Series</h3><p><a href=https://eindex.me/cn/series/algorithm/>算法 (5)</a><p><a href=https://eindex.me/cn/series/review/>年终总结 (2)</a><p><a href=https://eindex.me/cn/series/blog-enhance-plan/>博客演进计划 (1)</a></section><section><h3 class=section-title>Links</h3><p><a href=https://github.com/EINDEX rel=me>Github</a><p><a href=https://eindex.me/toolkit/> My Toolkit</a><p><a href=/feed.xml>RSS Feed</a><p><a href=/cn/links>友情链接</a></section><section class=advertisement><h3 class=section-title>Advertisements</h3><ins class="adsbygoogle aside" style="display:inline-block;width: 100%;height:500px" data-ad-client=ca-pub-1265138627025369 data-ad-slot=3472732805></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></section><section class=tags><h3 class=section-title>Tags</h3><div class=tags><a href=https://eindex.me/cn/tags/python/>Python (7)</a>, <a href=https://eindex.me/cn/tags/ending/>Ending (2)</a>, <a href=https://eindex.me/cn/tags/annual-summary/>Annual Summary (2)</a>, <a href=https://eindex.me/cn/tags/webmentions/>Webmentions (1)</a>, <a href=https://eindex.me/cn/tags/umami/>umami (1)</a>, <a href=https://eindex.me/cn/tags/thoughtworks/>Thoughtworks (1)</a>, <a href=https://eindex.me/cn/tags/sort/>Sort (1)</a>, <a href=https://eindex.me/cn/tags/self-hosted/>Self-Hosted (1)</a>, <a href=https://eindex.me/cn/tags/search-engine/>Search Engine (1)</a>, <a href=https://eindex.me/cn/tags/proxmox-ve/>Proxmox VE (1)</a>, <a href=https://eindex.me/cn/tags/pipenv/>Pipenv (1)</a>, <a href=https://eindex.me/cn/tags/microformats2/>Microformats2 (1)</a>, <a href=https://eindex.me/cn/tags/meilisearch/>meilisearch (1)</a>, <a href=https://eindex.me/cn/tags/linear/>Linear (1)</a>, <a href=https://eindex.me/cn/tags/kmp/>KMP (1)</a>, <a href=https://eindex.me/cn/tags/k3s/>K3S (1)</a>, <a href=https://eindex.me/cn/tags/javascript/>JavaScript (1)</a>, <a href=https://eindex.me/cn/tags/introspection/>Introspection (1)</a>, <a href=https://eindex.me/cn/tags/indie-web/>Indie Web (1)</a>, <a href=https://eindex.me/cn/tags/index/>Index (1)</a>, <a href=https://eindex.me/cn/tags/github-actions/>Github Actions (1)</a>, <a href=https://eindex.me/cn/tags/flyio/>flyio (1)</a>, <a href=https://eindex.me/cn/tags/financial-management/>financial-management (1)</a>, <a href=https://eindex.me/cn/tags/financial-independence/>financial-independence (1)</a>, <a href=https://eindex.me/cn/tags/financial/>financial (1)</a>, <a href=https://eindex.me/cn/tags/etag/>ETag (1)</a>, <a href=https://eindex.me/cn/tags/environment/>Environment (1)</a>, <a href=https://eindex.me/cn/tags/engagement/>Engagement (1)</a>, <a href=https://eindex.me/cn/tags/docker/>Docker (1)</a>, <a href=https://eindex.me/cn/tags/data-structure/>Data structure (1)</a>, <a href=https://eindex.me/cn/tags/crawler/>Crawler (1)</a>, <a href=https://eindex.me/cn/tags/connectivity/>Connectivity (1)</a>, <a href=https://eindex.me/cn/tags/community/>Community (1)</a>, <a href=https://eindex.me/cn/tags/chatgpt/>ChatGPT (1)</a>, <a href=https://eindex.me/cn/tags/cache/>Cache (1)</a>, <a href=https://eindex.me/cn/tags/beginner-s-guide/>Beginner's Guide (1)</a>, <a href=https://eindex.me/cn/tags/beancount/>Beancount (1)</a>, <a href=https://eindex.me/cn/tags/autoenv/>Autoenv (1)</a>, <a href=https://eindex.me/cn/tags/async/>Async (1)</a>, <a href=https://eindex.me/cn/tags/archlinux/>ArchLinux (1)</a>, <a href=https://eindex.me/cn/tags/after-reading/>After Reading (1)</a></div></section></aside></div><footer class=footer><span class=webring> <a href=https://xn--sr8hvo.ws/%F0%9F%95%90%F0%9F%89%91%F0%9F%88%B6/previous>←</a> An IndieWeb Webring 🕸💍 <a href=https://xn--sr8hvo.ws/%F0%9F%95%90%F0%9F%89%91%F0%9F%88%B6/next>→</a> </span><span>EINDEX @ 2023</span></footer></div></body><script async data-domains=eindex.me data-host-url=https://u.eindex.me data-website-id=692d9153-7341-4370-b652-60df196f2b31 defer src=/js/umami.js></script><script>window.twttr = (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0],
      t = window.twttr || {};
    if (d.getElementById(id)) return t;
    js = d.createElement(s);
    js.id = id;
    js.src = "https://platform.twitter.com/widgets.js?omit_script=true";
    fjs.parentNode.insertBefore(js, fjs);
  
    t._e = [];
    t.ready = function(f) {
      t._e.push(f);
    };
  
    return t;
  }(document, "script", "twitter-wjs"));</script><script src=https://cdn.jsdelivr.net/npm/docs-searchbar.js@2.4.1/dist/cdn/docs-searchbar.min.js></script><script>docsSearchBar({
    hostUrl: "https://meili.eindex.me",
    apiKey: "a39cff5442b90bb926f6408b0b08671eee444599e6d9c44c29bd0adae09a4b86",
    indexUid: "blog",
    inputSelector: '#search-bar-input',
    debug: true, // Set debug to true if you want to inspect the dropdown
  })</script><script async defer src=/js/pv-counter.js></script>