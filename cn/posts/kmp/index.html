<!DOCTYPE html>
<html lang="en" class="astro-SCKKX6R4">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <link rel="icon" href="/favicon.ico">
    <meta name="generator" content="Astro v2.0.15">
    <title>KMP ç®—æ³•</title>
    <link rel="webmention" href="https://webmention.io/eindex.me/webmention">
    <link rel="pingback" href="https://webmention.io/eindex.me/xmlrpc">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/lxgwwenkai-regular.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link href="https://{{cdn}}/prismjs@v1.x/themes/prism.css" rel="stylesheet">
    <link rel="stylesheet" href="/katex.min.css" crossorigin="anonymous">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-SR36ZS0R52"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag("js", new Date());

  gtag("config", "G-SR36ZS0R52");
</script>
  <link rel="stylesheet" href="/_astro/gallery.197e1a52.css" />
<link rel="stylesheet" href="/_astro/_slug_.9be3c881.css" />
<link rel="stylesheet" href="/_astro/_slug_.8ced6fc2.css" /><script type="module">class o extends HTMLElement{constructor(){super();const e=this.querySelector("button"),t=this.querySelector("div.code-body");e.addEventListener("click",()=>{navigator.clipboard.writeText(t.innerText).then(()=>{console.log("copy successd")})})}}customElements.define("article-code",o);
</script></head>
  <body class="astro-SCKKX6R4">
    <div class="blog astro-SCKKX6R4">
      <nav class="astro-5BLMO7YK">
  <span class="astro-5BLMO7YK"><img width="32px" height="32px" src="/images/avatar.png" class="astro-5BLMO7YK"><a href="/" class="astro-5BLMO7YK">EINDEX's Blog</a></span>
  <ul class="astro-5BLMO7YK">
    <li class="astro-5BLMO7YK"><a rel="me" href="https://github.com/eindex" class="astro-5BLMO7YK">Github</a></li>
    <li class="astro-5BLMO7YK"><a rel="me" href="https://twitter.com/@eindex_li" class="astro-5BLMO7YK">Twitter</a></li>
  </ul>
</nav>
      <article class="h-entry astro-WMBV4WGB">
    <span class="series p-category astro-WMBV4WGB"></span>
    <h1 class="title p-name astro-WMBV4WGB">
      KMP ç®—æ³•<a class="u-url astro-WMBV4WGB" href="/cnkmp"></a>
    </h1>
    <time class="astro-WMBV4WGB">2018/05/11</time>

    <summary class="p-summary astro-WMBV4WGB"></summary>

    <section class="main e-content astro-WMBV4WGB">
      <blockquote>
<p>åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼ŒKnuth-Morris-Pratt å­—ç¬¦ä¸²æŸ¥æ‰¾ç®—æ³•ï¼ˆç®€ç§°ä¸º KMP ç®—æ³•ï¼‰å¯åœ¨ä¸€ä¸ªä¸»æ–‡æœ¬å­—ç¬¦ä¸² S å†…æŸ¥æ‰¾ä¸€ä¸ªè¯ W çš„å‡ºç°ä½ç½®ã€‚æ­¤ç®—æ³•é€šè¿‡è¿ç”¨å¯¹è¿™ä¸ªè¯åœ¨ä¸åŒ¹é…æ—¶æœ¬èº«å°±åŒ…å«è¶³å¤Ÿçš„ä¿¡æ¯æ¥ç¡®å®šä¸‹ä¸€ä¸ªåŒ¹é…å°†åœ¨å“ªé‡Œå¼€å§‹çš„å‘ç°ï¼Œä»è€Œé¿å…é‡æ–°æ£€æŸ¥å…ˆå‰åŒ¹é…çš„å­—ç¬¦ã€‚</p>
</blockquote>

<blockquote>
<p>è¿™ä¸ªç®—æ³•æ˜¯ç”±é«˜å¾·çº³ï¼ˆDonald Ervin Knuthï¼‰å’Œæ²ƒæ©Â·æ™®æ‹‰ç‰¹åœ¨ 1974 å¹´æ„æ€ï¼ŒåŒå¹´è©¹å§†æ–¯Â·HÂ·è«é‡Œæ–¯ä¹Ÿç‹¬ç«‹åœ°è®¾è®¡å‡ºè¯¥ç®—æ³•ï¼Œæœ€ç»ˆç”±ä¸‰äººäº 1977 å¹´è”åˆå‘è¡¨ã€‚</p>
</blockquote>
<h2 id="åŸç†">åŸç†</h2>
<p>å°†å¾…åŒ¹é…å­—ç¬¦ä¸²å‘½åä¸º m æºå­—ç¬¦ä¸²å‘½åä¸º S ã€‚
æœ¬ç®—æ³•å¯¹å¾…åŒ¹é…å­—ç¬¦ä¸²åšå¤„ç†ä¹‹åï¼Œæ‰¾åˆ°ä»–çš„çœŸå‰ç¼€å’ŒçœŸåç¼€ã€‚å¹¶é€šè¿‡çœŸå‰ç¼€ä¸åç¼€é‡åˆçš„æ•°é‡çš„å€¼ï¼Œè¿™ä¸ªå€¼æ˜¯åœ¨åŒ¹é…çŠ¶æ€ä¸­å‘ç”ŸçŸ¢é…æ—¶ï¼Œä½äºåŸå§‹å­—ç¬¦ä¸²ä¸Š S çš„æŒ‡é’ˆç§»åŠ¨çš„æ–¹å‘ä¸è·ç¦»ã€‚</p>
<p>ç®€å•çš„è¯´å°±æ˜¯åŒ¹é…å¤±è´¥æ—¶ã€‚é€šè¿‡ä¹‹å‰çš„çœŸå‰ç¼€å’Œåç¼€è¡¨ï¼Œç›´æ¥ç§»åŠ¨åœ¨åŒ¹é…å­—ç¬¦ä¸²ä¸Šçš„æŒ‡é’ˆï¼Œè¾¾åˆ°å‡å°‘æ— ç”¨åŒ¹é…çš„æ•ˆæœã€‚</p>
<h2 id="ä¼˜ç‚¹">ä¼˜ç‚¹</h2>
<p>èŠ‚çº¦æ—¶é—´ï¼Œç›¸æ¯”äºæœ´ç´ çš„åŒ¹é…æ–¹å¼ï¼Œæ–°çš„åŒ¹é…ç®—æ³•åªéœ€è¦ O(m + n)çš„æ—¶é—´å¤æ‚åº¦ å’Œ é¢å¤– O(m)çš„ç©ºé—´ï¼Œè¿™ä¸ªç©ºé—´æ˜¯ç”¨æ¥ä¿å­˜çœŸå‰ç¼€å’ŒçœŸåç¼€çš„ç»“æœçš„ã€‚</p>
<h2 id="å®ç°">å®ç°</h2>
<p>KMP åŒ¹é…çš„å…³é”®åœ¨äºåˆå§‹åŒ–åŒ¹é…å­—ç¬¦ä¸²ã€‚</p>
<article-code class="astro-VKVMCQTA">
  <div class="code-header astro-VKVMCQTA">
    <span class="astro-VKVMCQTA">python</span><button class="astro-VKVMCQTA">Copy<svg viewBox="0 0 20 20" class="astro-VKVMCQTA" astro-icon="uiw:copy"><path fill="currentColor" d="M6.644 2.983a.252.252 0 0 0-.253.252c0 .139.113.251.253.251h3.713c.14 0 .253-.112.253-.251a.252.252 0 0 0-.253-.252H6.644zm3.713-1.342c.734 0 1.353.49 1.544 1.16l2.175.001c.621.004 1.122.205 1.432.638.266.372.372.85.345 1.387L15.85 17.84c.042.552-.062 1.04-.328 1.445-.312.473-.821.71-1.452.716H3.14c-.76-.03-1.323-.209-1.675-.609-.327-.371-.47-.88-.464-1.5V4.84c-.013-.6.154-1.106.518-1.48.376-.384.932-.554 1.647-.559h1.935c.19-.67.809-1.16 1.543-1.16h3.713zm0 3.187H6.644c-.546 0-1.027-.27-1.317-.684H3.17c-.383.002-.602.07-.682.152-.091.093-.144.252-.138.531v13.07c-.003.325.052.522.13.61.054.061.286.135.685.151h10.9c.2-.002.28-.04.326-.109.091-.138.133-.334.11-.658l.001-13.096c.014-.293-.027-.482-.096-.578-.026-.035-.116-.072-.336-.073h-2.397c-.29.414-.771.684-1.317.684zM17.2 0c.994 0 1.8.801 1.8 1.79v14.082c0 .988-.806 1.79-1.8 1.79h-1.958v-1.343h1.957c.249 0 .45-.2.45-.447V1.789a.449.449 0 0 0-.45-.447H9.643c-.248 0-.45.2-.45.447v.157h-1.35v-.157C7.843.801 8.649 0 9.643 0H17.2zM8.196 11.751c.373 0 .675.3.675.671 0 .37-.302.671-.675.671H4.145a.673.673 0 0 1-.676-.67c0-.371.303-.672.676-.672h4.051zm4.052-2.684c.372 0 .675.3.675.671 0 .37-.303.671-.675.671H4.145a.673.673 0 0 1-.676-.67c0-.371.303-.672.676-.672h8.103zm0-2.684c.372 0 .675.3.675.671a.673.673 0 0 1-.675.671H4.145a.673.673 0 0 1-.676-.67c0-.371.303-.672.676-.672h8.103z"/></svg></button>
  </div>
  <div class="code-body astro-VKVMCQTA"><pre class="shiki " style="background-color: none" tabindex="0"><code><span class="line"><span style="color: #66D9EF; font-style: italic">def</span><span style="color: #F8F8F2"> </span><span style="color: #A6E22E">partial_table</span><span style="color: #F8F8F2">(</span><span style="color: #FD971F; font-style: italic">pattern</span><span style="color: #F8F8F2">:</span><span style="color: #66D9EF; font-style: italic">str</span><span style="color: #F8F8F2">):</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #E6DB74">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color: #E6DB74">    å½“å­—ç¬¦ä¸²é•¿åº¦ä¸º1çš„æ—¶å€™ï¼Œä¸éœ€è¦è¿›è¡ŒæŸ¥è¡¨ï¼Œç›´æ¥å¾ªç¯åŒ¹é…æ—¶é—´å¤æ‚åº¦å°±æ˜¯ O(n)</span></span>
<span class="line"><span style="color: #E6DB74">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color: #F8F8F2">    front </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> [pattern[:x</span><span style="color: #F92672">+</span><span style="color: #AE81FF">1</span><span style="color: #F8F8F2">] </span><span style="color: #F92672">for</span><span style="color: #F8F8F2"> x </span><span style="color: #F92672">in</span><span style="color: #F8F8F2"> </span><span style="color: #66D9EF">range</span><span style="color: #F8F8F2">(</span><span style="color: #66D9EF">len</span><span style="color: #F8F8F2">(pattern))]</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #66D9EF; font-style: italic">def</span><span style="color: #F8F8F2"> </span><span style="color: #A6E22E">cal_table_val</span><span style="color: #F8F8F2">(</span><span style="color: #FD971F; font-style: italic">sub_pattern</span><span style="color: #F8F8F2">):</span></span>
<span class="line"><span style="color: #F8F8F2">        </span><span style="color: #F92672">return</span><span style="color: #F8F8F2"> </span><span style="color: #66D9EF">max</span><span style="color: #F8F8F2">([</span><span style="color: #AE81FF">0</span><span style="color: #F8F8F2">]</span><span style="color: #F92672">+</span><span style="color: #F8F8F2">[</span><span style="color: #66D9EF">len</span><span style="color: #F8F8F2">(front[:i]) </span><span style="color: #F92672">for</span><span style="color: #F8F8F2"> i </span><span style="color: #F92672">in</span><span style="color: #F8F8F2"> </span><span style="color: #66D9EF">range</span><span style="color: #F8F8F2">(</span><span style="color: #66D9EF">len</span><span style="color: #F8F8F2">(sub_pattern)) </span><span style="color: #F92672">if</span><span style="color: #F8F8F2"> sub_pattern[</span><span style="color: #F92672">-</span><span style="color: #F8F8F2">i:] </span><span style="color: #F92672">in</span><span style="color: #F8F8F2"> front[:i]])</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">return</span><span style="color: #F8F8F2"> [cal_table_val(pattern[:i </span><span style="color: #F92672">+</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">1</span><span style="color: #F8F8F2">]) </span><span style="color: #F92672">for</span><span style="color: #F8F8F2"> i </span><span style="color: #F92672">in</span><span style="color: #F8F8F2"> </span><span style="color: #66D9EF">range</span><span style="color: #F8F8F2">(</span><span style="color: #66D9EF">len</span><span style="color: #F8F8F2">(pattern))]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color: #66D9EF; font-style: italic">def</span><span style="color: #F8F8F2"> </span><span style="color: #A6E22E">kmp</span><span style="color: #F8F8F2">(</span><span style="color: #FD971F; font-style: italic">pattern</span><span style="color: #F8F8F2">, </span><span style="color: #FD971F; font-style: italic">string</span><span style="color: #F8F8F2">, </span><span style="color: #FD971F; font-style: italic">first</span><span style="color: #F92672">=</span><span style="color: #AE81FF">True</span><span style="color: #F8F8F2">):</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">if</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">not</span><span style="color: #F8F8F2"> pattern </span><span style="color: #F92672">or</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">not</span><span style="color: #F8F8F2"> string:</span></span>
<span class="line"><span style="color: #F8F8F2">        </span><span style="color: #F92672">return</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">-</span><span style="color: #AE81FF">1</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">    res </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> []</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #88846F"># åŒ¹é…å­—ç¬¦ä¸²é•¿åº¦ä¸º1 ä¸éœ€è¦å»ºè¡¨</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">if</span><span style="color: #F8F8F2"> </span><span style="color: #66D9EF">len</span><span style="color: #F8F8F2">(pattern) </span><span style="color: #F92672">==</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">1</span><span style="color: #F8F8F2">:</span></span>
<span class="line"><span style="color: #F8F8F2">        </span><span style="color: #F92672">for</span><span style="color: #F8F8F2"> i, k </span><span style="color: #F92672">in</span><span style="color: #F8F8F2"> </span><span style="color: #66D9EF">enumerate</span><span style="color: #F8F8F2">(string):</span></span>
<span class="line"><span style="color: #F8F8F2">            </span><span style="color: #F92672">if</span><span style="color: #F8F8F2"> k </span><span style="color: #F92672">==</span><span style="color: #F8F8F2"> pattern:</span></span>
<span class="line"><span style="color: #F8F8F2">                </span><span style="color: #F92672">if</span><span style="color: #F8F8F2"> first:</span></span>
<span class="line"><span style="color: #F8F8F2">                    </span><span style="color: #F92672">return</span><span style="color: #F8F8F2"> i</span></span>
<span class="line"><span style="color: #F8F8F2">                res.append(i)</span></span>
<span class="line"><span style="color: #F8F8F2">        </span><span style="color: #F92672">return</span><span style="color: #F8F8F2"> res</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">    pt </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> partial_table(pattern)</span></span>
<span class="line"><span style="color: #F8F8F2">    i, j </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">0</span><span style="color: #F8F8F2">, </span><span style="color: #AE81FF">0</span></span>
<span class="line"><span style="color: #F8F8F2">    lp, ls </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #66D9EF">len</span><span style="color: #F8F8F2">(pattern), </span><span style="color: #66D9EF">len</span><span style="color: #F8F8F2">(string)</span></span>
<span class="line"><span style="color: #F8F8F2">    compile_flag </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">False</span></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">while</span><span style="color: #F8F8F2"> j </span><span style="color: #F92672">-</span><span style="color: #F8F8F2"> i </span><span style="color: #F92672">&lt;</span><span style="color: #F8F8F2"> ls </span><span style="color: #F92672">-</span><span style="color: #F8F8F2"> lp:</span></span>
<span class="line"><span style="color: #F8F8F2">        </span><span style="color: #F92672">if</span><span style="color: #F8F8F2"> string[j] </span><span style="color: #F92672">==</span><span style="color: #F8F8F2"> pattern[i]:</span></span>
<span class="line"><span style="color: #F8F8F2">            i </span><span style="color: #F92672">+=</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">1</span></span>
<span class="line"><span style="color: #F8F8F2">            j </span><span style="color: #F92672">+=</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">1</span></span>
<span class="line"><span style="color: #F8F8F2">            compile_flag </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">True</span></span>
<span class="line"><span style="color: #F8F8F2">            </span><span style="color: #F92672">if</span><span style="color: #F8F8F2"> i </span><span style="color: #F92672">==</span><span style="color: #F8F8F2"> </span><span style="color: #66D9EF">len</span><span style="color: #F8F8F2">(pattern):</span></span>
<span class="line"><span style="color: #F8F8F2">                </span><span style="color: #F92672">if</span><span style="color: #F8F8F2"> first:</span></span>
<span class="line"><span style="color: #F8F8F2">                    </span><span style="color: #F92672">return</span><span style="color: #F8F8F2"> j </span><span style="color: #F92672">-</span><span style="color: #F8F8F2"> i</span></span>
<span class="line"><span style="color: #F8F8F2">                res.append(j </span><span style="color: #F92672">-</span><span style="color: #F8F8F2"> i)</span></span>
<span class="line"><span style="color: #F8F8F2">                i </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">0</span></span>
<span class="line"><span style="color: #F8F8F2">        </span><span style="color: #F92672">elif</span><span style="color: #F8F8F2"> string[j] </span><span style="color: #F92672">!=</span><span style="color: #F8F8F2"> pattern[i] </span><span style="color: #F92672">and</span><span style="color: #F8F8F2"> compile_flag:</span></span>
<span class="line"><span style="color: #F8F8F2">            </span><span style="color: #88846F"># ä¹‹å‰ä¸ºåŒ¹é…çŠ¶æ€ éœ€è¦ç§»åŠ¨åŒ¹é…æ•°ç»„æŒ‡é’ˆ</span></span>
<span class="line"><span style="color: #F8F8F2">            compile_flag </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">False</span></span>
<span class="line"><span style="color: #F8F8F2">            i </span><span style="color: #F92672">-=</span><span style="color: #F8F8F2"> i </span><span style="color: #F92672">-</span><span style="color: #F8F8F2"> pt[i</span><span style="color: #F92672">-</span><span style="color: #AE81FF">1</span><span style="color: #F8F8F2">]</span></span>
<span class="line"><span style="color: #F8F8F2">        </span><span style="color: #F92672">elif</span><span style="color: #F8F8F2"> string[j] </span><span style="color: #F92672">!=</span><span style="color: #F8F8F2"> pattern[i] </span><span style="color: #F92672">and</span><span style="color: #F8F8F2"> </span><span style="color: #F92672">not</span><span style="color: #F8F8F2"> compile_flag:</span></span>
<span class="line"><span style="color: #F8F8F2">            </span><span style="color: #88846F"># ä¹‹å‰ä¸ºä¸åŒ¹é…çŠ¶æ€ åŒ¹é…æŒ‡é’ˆå½’ 0</span></span>
<span class="line"><span style="color: #F8F8F2">            i </span><span style="color: #F92672">=</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">0</span></span>
<span class="line"><span style="color: #F8F8F2">            j </span><span style="color: #F92672">+=</span><span style="color: #F8F8F2"> </span><span style="color: #AE81FF">1</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">    </span><span style="color: #F92672">return</span><span style="color: #F8F8F2"> res</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F8F8F2">partial_table(</span><span style="color: #E6DB74">&#39;ABCDABD&#39;</span><span style="color: #F8F8F2">) </span><span style="color: #88846F"># [0, 0, 0, 0, 1, 2, 0]</span></span>
<span class="line"><span style="color: #F8F8F2">kmp(</span><span style="color: #E6DB74">&#39;ABCDABD&#39;</span><span style="color: #F8F8F2">,</span><span style="color: #E6DB74">&#39;BBC ABCDAB ABCDABCDABDE&#39;</span><span style="color: #F8F8F2">) </span><span style="color: #88846F"># 15</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span></code></pre></div>

  

  
</article-code>
    </section>
  </article>
      <footer class="astro-SZ7XMLTE">  
  <span class="webring astro-MTZRIXCV"> <a href="https://xn--sr8hvo.ws/%F0%9F%95%90%F0%9F%89%91%F0%9F%88%B6/previous" class="astro-MTZRIXCV">â†</a> An IndieWeb Webring ğŸ•¸ğŸ’ <a href="https://xn--sr8hvo.ws/%F0%9F%95%90%F0%9F%89%91%F0%9F%88%B6/next" class="astro-MTZRIXCV">â†’</a> </span>
  <span class="astro-SZ7XMLTE">EINDEX @ 2023</span>
</footer>
    </div>
    <script async defer data-website-id="d963565f-c209-41a4-98d2-faac7625f470" src="https://umami.eindex.me/umami.js"></script>
  

</body></html>