<!doctype html><html charset=utf-8 lang=en><head><script src="https://www.googletagmanager.com/gtag/js?id=G-SR36ZS0R52" async></script><script>window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }

  var page_link = new URL(window.location.href);
  gtag('js', new Date());
  gtag('config', 'G-SR36ZS0R52', {
    traffic_type: page_link.searchParams.get("traffic_type")
  });
  gtag('set', {
    traffic_type: page_link.searchParams.get("traffic_type")
  })</script><link href=https://eindex.me/feed.xml rel=alternate title=RSS type=application/rss+xml><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="text/html; charset=utf-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1.0,maximum-scale=1" name=viewport><meta content=EINDEX itemprop=author name=author><title>Code Review with Semgrep Custom Rules • EINDEX's Blog</title><meta content="Code Review with Semgrep Custom Rules • EINDEX's Blog" property=og:title><meta charset=utf-8><link href="https://eindex.me/css/index.css?h=b4140d1b8e3196cffd2e47c68ff946d2e5312afa70cfe5c88add4caebf732a9e" rel=stylesheet><style>@-moz-document url-prefix() {
    .lazy:-moz-loading {
      visibility: hidden;
    }
  }

  .ieOnly {
    display: none;
  }

  @media all and (-ms-high-contrast: none),
  (-ms-high-contrast: active) {
    .ieOnly {
      display: block;
    }
  }</style><link href=https://webmention.io/eindex.me/webmention rel=webmention><link href=https://webmention.io/eindex.me/xmlrpc rel=pingback><script src=https://cdn.jsdelivr.net/npm/iconify-icon@1.0.1/dist/iconify-icon.min.js></script><link href=/favicon-512.png rel=apple-touch-icon sizes=512x512><link href=/favicon-512.png rel=icon sizes=512x512 type=image/png><link href=/favicon-192.png rel=icon sizes=192x192 type=image/png><link href=/manifest.json rel=manifest><meta content=on name=twitter:dnt><meta content=on name=twitter:widgets:csp><meta content="This article explores the benefits of using Semgrep in the code review process to improve code quality and consistency. It discusses how custom rules can be utilized to enforce team coding standards and detect potential vulnerabilities in the code, leading to more effective code review and ultimately better software." property=og:description><meta content=https://eindex.me/posts/semgrep-with-custom-rules/ property=og:url><meta content="EINDEX's Blog" property=og:site_name><meta content=https://eindex.me/images/avatar.png property=og:image><meta content=summary name=twitter:card><meta content="Code Review with Semgrep Custom Rules" name=twitter:title><meta content="This article explores the benefits of using Semgrep in the code review process to improve code quality and consistency. It discusses how custom rules can be utilized to enforce team coding standards and detect potential vulnerabilities in the code, leading to more effective code review and ultimately better software." property=twitter:description><meta content=@eindex_li name=twitter:site><meta content=@eindex_li name=twitter:creator><meta content=https://eindex.me/images/avatar.png name=twitter:image><link href=https://twitter.com/eindex_li rel=me><script type=application/ld+json>
{
  "@context": "https://schema.org/",
  "@type": "BlogPosting",
  "headline": "Code Review with Semgrep Custom Rules",
  "image": "https://eindex.me/images/avatar.png",
  
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://eindex.me/posts/semgrep-with-custom-rules/"
  },
  
  "datePublished": "2022-12-14",
  
  "description": "This article explores the benefits of using Semgrep in the code review process to improve code quality and consistency. It discusses how custom rules can be utilized to enforce team coding standards and detect potential vulnerabilities in the code, leading to more effective code review and ultimately better software.",
  "author": {
    "@type": "Person",
    "name": "EINDEX",
    "url": "https://eindex.me/about"
  },
  "publisher": {
    "@type": "Organization",
    "name": "EINDEX's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://eindex.me/images/avatar.png"
    }
  },
  "keywords": ["Code review","Semgrep","Custom rules","Code quality","Code consistency","Coding standards","Vulnerability detection","Software development","Workflow","Best practices","security"]
}
</script><link href=https://cdn.jsdelivr.net/npm/docs-searchbar.js@2.4.1/dist/cdn/docs-searchbar.min.css rel=stylesheet><script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1265138627025369" async crossorigin=anonymous></script><body><div class=all><header><nav class=navbar><div class=avatar><a class=site-link href=https://eindex.me/><img alt=Workflow class=avatar src=https://eindex.me/processed_images/e75389feba7c019600.png></a></div><div class=menus><a href=https://eindex.me/gallery/>Gallery</a><a href=https://eindex.me/archive/>Archive</a></div><div class=switcher><a class="language switch" href=https://eindex.me/cn/><iconify-icon icon=uil:letter-chinese-a></iconify-icon></a></div></nav></header><div class=content><main><article class=h-entry data-clarity-region=article><section class=header><section class=title-area><a class="series p-category" href=https://eindex.me/series/security/>Cyber Security</a><h1 class="title p-name"><a class=u-url href=https://eindex.me/posts/semgrep-with-custom-rules/>Code Review with Semgrep Custom Rules</a></h1></section><section class=meta-area><p style="display: none;" class=p-summary>This article explores the benefits of using Semgrep in the code review process to improve code quality and consistency. It discusses how custom rules can be utilized to enforce team coding standards and detect potential vulnerabilities in the code, leading to more effective code review and ultimately better software.</p><span><iconify-icon icon=ant-design:calendar-outlined></iconify-icon> <time class=dt-published>2022-12-14</time> </span><span><iconify-icon icon=bx:time-five></iconify-icon> 3 mins</span><span style=display:none><iconify-icon icon=mdi:eye-outline></iconify-icon> <span id=pv></span> views</span></section></section><div class="p-author h-card" style="display: none;"><img class="u-logo u-photo" src=https://eindex.me/images/avatar.png><a class="p-nickname p-name u-url" href=https://eindex.me>EINDEX</a><p class=p-note>My goal is make happy.</div><section class=p-summary style=display:none>This article explores the benefits of using Semgrep in the code review process to improve code quality and consistency. It discusses how custom rules can be utilized to enforce team coding standards and detect potential vulnerabilities in the code, leading to more effective code review and ultimately better software.</section><ins class="adsbygoogle main" data-ad-client=ca-pub-1265138627025369 data-ad-slot=3577756156 style=display:inline-block;width:100%;height:64px></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><section class="main e-content"><p>In this post, we will discuss how Semgrep can be integrated into your code review process. If you are unfamiliar with Semgrep, we recommend checking out our previous article on the topic, titled " <a href=https://eindex.me/posts/improving-your-code-review-process-with-semgrep/ rel=webmention>Improving Your Code Review Process With Semgrep</a>".</p><span id=continue-reading></span><h2 id=codereview-and-semgrep>Codereview and Semgrep</h2><p>Code review is a crucial step in the software development workflow, as it allows team members to review and critique each other's code.<p>However, code review can sometimes be a source of contention, with debates over code style or disagreements over team coding standards.<p>Additionally, there may be cases where the team lacks domain expertise, leading to the inclusion of vulnerabilities in the code. Semgrep can help address these issues by promoting consistent coding practices and identifying potential vulnerabilities.<p>Let's take a closer look at how Semgrep can be utilized in the code review process.<h2 id=cases>Cases</h2><p>In this section, we will examine three cases where Semgrep custom rules can be utilized to improve code quality.<p>Case 1: Preventing the use of <code>System.out</code> in Java. It is not uncommon for team members to use <code>System.out</code> for logging or debugging purposes. However, this practice can be problematic. The following custom rule can help address this issue:<pre class=language-yaml data-lang=yaml style=background-color:#272822;color:#f8f8f2;><code class=language-yaml data-lang=yaml><span style=color:#f92672;>rules</span><span>:
</span><span>- </span><span style=color:#f92672;>id</span><span>: </span><span style=color:#e6db74;>logging-via-system-out
</span><span>  </span><span style=color:#f92672;>pattern</span><span>: </span><span style=color:#e6db74;>System.out.$PRINT($ARG);
</span><span>  </span><span style=color:#f92672;>message</span><span>: </span><span style=color:#e6db74;>Using system out as logging method.
</span><span>  </span><span style=color:#f92672;>languages</span><span>: [</span><span style=color:#e6db74;>java</span><span>]
</span><span>  </span><span style=color:#f92672;>severity</span><span>: </span><span style=color:#e6db74;>WARNING
</span></code></pre><p>If your team has established logging standards, the <code>fix</code> function can be used to automatically replace instances of <code>System.out</code> with a preferred logging method. For example:<pre class=language-yaml data-lang=yaml style=background-color:#272822;color:#f8f8f2;><code class=language-yaml data-lang=yaml><span style=color:#f92672;>rules</span><span>:
</span><span>- </span><span style=color:#f92672;>id</span><span>: </span><span style=color:#e6db74;>logging-via-system-out
</span><span>  </span><span style=color:#f92672;>pattern</span><span>: </span><span style=color:#e6db74;>System.out.$PRINT($ARG);
</span><span>  </span><span style=color:#f92672;>message</span><span>: </span><span style=color:#e6db74;>Using system out as logging method.
</span><span>  </span><span style=color:#f92672;>fix</span><span>: </span><span style=color:#e6db74;>log.info($ALG)
</span><span>  </span><span style=color:#f92672;>languages</span><span>: [</span><span style=color:#e6db74;>java</span><span>]
</span><span>  </span><span style=color:#f92672;>severity</span><span>: </span><span style=color:#e6db74;>WARNING
</span></code></pre><p>Case 2: Disallowing system calls. In some situations, it may be desirable to prohibit system commands in order to protect the user's device or cloud machine. The following custom rule can be used to detect and prevent the execution of system commands:<pre class=language-yaml data-lang=yaml style=background-color:#272822;color:#f8f8f2;><code class=language-yaml data-lang=yaml><span style=color:#f92672;>rules</span><span>:
</span><span>- </span><span style=color:#f92672;>id</span><span>: </span><span style=color:#e6db74;>java-rec-checker
</span><span>  </span><span style=color:#f92672;>patterns</span><span>:
</span><span>    - </span><span style=color:#f92672;>pattern-inside</span><span>: </span><span style=color:#e6db74;>$FUN(...,$ARG,...){...}
</span><span>    - </span><span style=color:#f92672;>pattern-either</span><span>:
</span><span>        - </span><span style=color:#f92672;>pattern</span><span>: </span><span style=color:#e6db74;>Runtime.getRuntime().exec(..., $ARG, ...);
</span><span>        - </span><span style=color:#f92672;>patterns</span><span>:
</span><span>          - </span><span style=color:#f92672;>pattern</span><span>: </span><span style=color:#e6db74;>Process $PROCESS = Runtime.getRuntime();
</span><span>          - </span><span style=color:#f92672;>pattern</span><span>: </span><span style=color:#e6db74;>$PROCESS.exec(..., $ARG, ...);
</span><span>  </span><span style=color:#f92672;>message</span><span>: </span><span style=color:#e6db74;>RCE risk from user input.
</span><span>  </span><span style=color:#f92672;>languages</span><span>: [</span><span style=color:#e6db74;>java</span><span>]
</span><span>  </span><span style=color:#f92672;>severity</span><span>: </span><span style=color:#e6db74;>ERROR
</span></code></pre><p>Case 3: Ensuring that all request mappings have authentication checks. It is important to ensure that all request mappings have proper permission checks in place. The following custom rule can be used to identify instances where these checks are missing:<pre class=language-yaml data-lang=yaml style=background-color:#272822;color:#f8f8f2;><code class=language-yaml data-lang=yaml><span style=color:#f92672;>rules</span><span>:
</span><span>- </span><span style=color:#f92672;>id</span><span>: </span><span style=color:#e6db74;>vaild-permission-check-on-all-request-mapping
</span><span>  </span><span style=color:#f92672;>patterns</span><span>:
</span><span>    - </span><span style=color:#f92672;>pattern-inside</span><span>: </span><span style=color:#f92672;>|
</span><span style=color:#e6db74;>        @$CONTROLLER_ANNOTATION
</span><span style=color:#e6db74;>        public class $CONTROLLER {
</span><span style=color:#e6db74;>          ...
</span><span style=color:#e6db74;>        }
</span><span>    - </span><span style=color:#f92672;>pattern</span><span>: </span><span style=color:#f92672;>|
</span><span style=color:#e6db74;>        @$MAPPING_ANNOTATION(...)
</span><span style=color:#e6db74;>        public $RET $METHOD(...){...}
</span><span>    - </span><span style=color:#f92672;>pattern-not</span><span>: </span><span style=color:#f92672;>|
</span><span style=color:#e6db74;>        @$MAPPING_ANNOTATION(...)
</span><span style=color:#e6db74;>        @$PERMISSION_ANNOTATION(...)
</span><span style=color:#e6db74;>        public $RET $METHOD(...){...}
</span><span>    - </span><span style=color:#f92672;>metavariable-regex</span><span>:
</span><span>        </span><span style=color:#f92672;>metavariable</span><span>: </span><span style=color:#e6db74;>$CONTROLLER_ANNOTATION
</span><span>        </span><span style=color:#f92672;>regex</span><span>: </span><span style=color:#e6db74;>(.*Controller$)
</span><span>    - </span><span style=color:#f92672;>metavariable-regex</span><span>:
</span><span>        </span><span style=color:#f92672;>metavariable</span><span>: </span><span style=color:#e6db74;>$MAPPING_ANNOTATION
</span><span>        </span><span style=color:#f92672;>regex</span><span>: </span><span style=color:#e6db74;>(.*Mapping$)
</span><span>    - </span><span style=color:#f92672;>metavariable-regex</span><span>:
</span><span>        </span><span style=color:#f92672;>metavariable</span><span>: </span><span style=color:#e6db74;>$PERMISSION_ANNOTATION
</span><span>        </span><span style=color:#f92672;>regex</span><span>: </span><span style=color:#e6db74;>(.*Permission$)
</span><span>  </span><span style=color:#f92672;>message</span><span>: </span><span style=color:#e6db74;>Should check user permission on all request mapping
</span><span>  </span><span style=color:#f92672;>languages</span><span>: [</span><span style=color:#e6db74;>java</span><span>]
</span><span>  </span><span style=color:#f92672;>severity</span><span>: </span><span style=color:#e6db74;>WARNING
</span><span>
</span></code></pre><h2 id=summarize>Summarize</h2><p>This article has discussed how Semgrep can be integrated into the code review process to improve code quality and consistency.<p>By using custom rules, Semgrep can enforce team coding standards and detect potential vulnerabilities in the code.<p>By incorporating Semgrep into the code review workflow, teams can more effectively identify and address issues before code is released to production.</section><section class=post-footer><div class=tags><span class=tag><a href=https://eindex.me/tags/code-review/>Code review</a></span><span class=tag><a href=https://eindex.me/tags/semgrep/>Semgrep</a></span><span class=tag><a href=https://eindex.me/tags/custom-rules/>Custom rules</a></span><span class=tag><a href=https://eindex.me/tags/code-quality/>Code quality</a></span><span class=tag><a href=https://eindex.me/tags/code-consistency/>Code consistency</a></span><span class=tag><a href=https://eindex.me/tags/coding-standards/>Coding standards</a></span><span class=tag><a href=https://eindex.me/tags/vulnerability-detection/>Vulnerability detection</a></span><span class=tag><a href=https://eindex.me/tags/software-development/>Software development</a></span><span class=tag><a href=https://eindex.me/tags/workflow/>Workflow</a></span><span class=tag><a href=https://eindex.me/tags/best-practices/>Best practices</a></span></div></section><hr><section class=webmentions><h2>Response</h2><p class=how-to-send-webmention>Have you written any responses to this article? If so, please send your article or tweet link below. (Making sure to include the link of this article in the content, learn more about webmentions from <a href=https://indieweb.org/Webmention>here</a>.)<form action=https://webmention.io/eindex.me/webmention class=webmention-form method=post><input name=target type=hidden value=https://eindex.me/posts/semgrep-with-custom-rules/><input placeholder="Your webmention link" name=source><button>Send Webmention</button></form><p class="flex flex-row how-to-send-webmention"><a class=twitter-share-button href=https://twitter.com/intent/tweet>Tweet</a>  and send response. .</section></article></main><aside><section class=search><input id=search-bar-input placeholder=Searching... type=search></section><section><h3 class=section-title>Series</h3><p><a href=https://eindex.me/series/security/>Cyber Security (2)</a><p><a href=https://eindex.me/series/blog-enhance-plan/>Blog Enhance Plan (1)</a></section><section><h3 class=section-title>Links</h3><p><a href=https://github.com/EINDEX rel=me>Github</a><p><a href=https://eindex.me/toolkit/> My Toolkit</a><p><a href=/feed.xml>RSS Feed</a></section><section class=advertisement><h3 class=section-title>Advertisements</h3><ins class="adsbygoogle aside" style="display:inline-block;width: 100%;height:500px" data-ad-client=ca-pub-1265138627025369 data-ad-slot=3472732805></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></section><section class=tags><h3 class=section-title>Tags</h3><div class=tags><a href=https://eindex.me/tags/semgrep/>Semgrep (2)</a>, <a href=https://eindex.me/tags/code-review/>Code Review (2)</a>, <a href=https://eindex.me/tags/best-practices/>Best Practices (2)</a>, <a href=https://eindex.me/tags/workflow/>Workflow (1)</a>, <a href=https://eindex.me/tags/webmentions/>Webmentions (1)</a>, <a href=https://eindex.me/tags/vulnerability-detection/>Vulnerability detection (1)</a>, <a href=https://eindex.me/tags/umami/>umami (1)</a>, <a href=https://eindex.me/tags/static-analysis/>Static Analysis (1)</a>, <a href=https://eindex.me/tags/software-development/>Software development (1)</a>, <a href=https://eindex.me/tags/security/>Security (1)</a>, <a href=https://eindex.me/tags/sast/>SAST (1)</a>, <a href=https://eindex.me/tags/microformats2/>Microformats2 (1)</a>, <a href=https://eindex.me/tags/memos/>memos (1)</a>, <a href=https://eindex.me/tags/meilisearch/>meilisearch (1)</a>, <a href=https://eindex.me/tags/javascript/>JavaScript (1)</a>, <a href=https://eindex.me/tags/indie-web/>Indie Web (1)</a>, <a href=https://eindex.me/tags/github-actions/>Github Actions (1)</a>, <a href=https://eindex.me/tags/flyio/>flyio (1)</a>, <a href=https://eindex.me/tags/engagement/>Engagement (1)</a>, <a href=https://eindex.me/tags/devsecops/>DevSecOps (1)</a>, <a href=https://eindex.me/tags/devops/>DevOps (1)</a>, <a href=https://eindex.me/tags/custom-rules/>Custom rules (1)</a>, <a href=https://eindex.me/tags/connectivity/>Connectivity (1)</a>, <a href=https://eindex.me/tags/community/>Community (1)</a>, <a href=https://eindex.me/tags/coding-standards/>Coding standards (1)</a>, <a href=https://eindex.me/tags/code-quality/>Code quality (1)</a>, <a href=https://eindex.me/tags/code-consistency/>Code consistency (1)</a>, <a href=https://eindex.me/tags/ci/>CI (1)</a>, <a href=https://eindex.me/tags/build-security-in/>Build Security In (1)</a>, <a href=https://eindex.me/tags/beginner-s-guide/>Beginner's Guide (1)</a></div></section></aside></div><footer class=footer><span class=webring> <a href=https://xn--sr8hvo.ws/%F0%9F%95%90%F0%9F%89%91%F0%9F%88%B6/previous>←</a> An IndieWeb Webring 🕸💍 <a href=https://xn--sr8hvo.ws/%F0%9F%95%90%F0%9F%89%91%F0%9F%88%B6/next>→</a> </span><span>EINDEX @ 2023</span></footer></div></body><script async data-domains=eindex.me data-host-url=https://u.eindex.me data-website-id=692d9153-7341-4370-b652-60df196f2b31 defer src=/js/umami.js></script><script>window.twttr = (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0],
      t = window.twttr || {};
    if (d.getElementById(id)) return t;
    js = d.createElement(s);
    js.id = id;
    js.src = "https://platform.twitter.com/widgets.js?omit_script=true";
    fjs.parentNode.insertBefore(js, fjs);
  
    t._e = [];
    t.ready = function(f) {
      t._e.push(f);
    };
  
    return t;
  }(document, "script", "twitter-wjs"));</script><script src=https://cdn.jsdelivr.net/npm/docs-searchbar.js@2.4.1/dist/cdn/docs-searchbar.min.js></script><script>docsSearchBar({
    hostUrl: "https://meili.eindex.me",
    apiKey: "a39cff5442b90bb926f6408b0b08671eee444599e6d9c44c29bd0adae09a4b86",
    indexUid: "blog",
    inputSelector: '#search-bar-input',
    debug: true, // Set debug to true if you want to inspect the dropdown
  })</script><script async defer src=/js/pv-counter.js></script>