---
import i18next, { changeLanguage } from "i18next";
import { getLastPartOfSlug, getLinkViaLocale } from "@utils/slug";
import { timeFormat } from "@utils/time";
import Layout from "@layouts/Layout.astro";
import { getPosts } from "@utils/posts";

changeLanguage("en");

const locale = i18next.language;
const posts = await getPosts(locale);
---

<Layout title="Posts">
  <h1>Posts</h1>
  {
    posts.map((post) => (
      <p>
        <a
          href={getLinkViaLocale(
            locale,
            `/posts/${getLastPartOfSlug(post.slug)}`
          )}
        >
          {post.data.title}
        </a>{" "}
        Updated at {timeFormat(post.data.updated || post.data.date)}
      </p>
    ))
  }
</Layout>
